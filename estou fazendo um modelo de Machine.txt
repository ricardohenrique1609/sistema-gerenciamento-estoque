SELECT 
    descricao_polo_administrativo,
    COUNT(*) as total_pessoas
FROM 
    db_corp_rh_analyticsapreports_spec_01.hub_people_analytics_colaborador
WHERE 
    texto_cidade_local_departamento = 'SAO PAULO'
    
    -- Filtro de Data (Mantido para pegar o retrato atual)
    AND data_referencia = (
        SELECT MAX(data_referencia) 
        FROM db_corp_rh_analyticsapreports_spec_01.hub_people_analytics_colaborador
    )

    -- Seus filtros atuais (Vamos testar o que eles trazem)
    AND (
        UPPER(descricao_polo_administrativo) LIKE '%ACO%' OR
        UPPER(descricao_polo_administrativo) LIKE '%TECNOLOGICO%' OR
        UPPER(descricao_polo_administrativo) LIKE '%3400%' OR
        UPPER(descricao_polo_administrativo) LIKE '%3500%' OR
        
        -- Atenção aqui: Como estamos filtrando por LOCAL também, 
        -- pode ser que um polo "WTorre" entre se o local for "Conceição" (erro de cadastro)
        UPPER(descricao_local_departamento) LIKE '%CONCEICAO%' OR
        UPPER(descricao_local_departamento) LIKE '%JABAQUARA%' OR
        UPPER(descricao_local_departamento) LIKE '%ALFREDO EGYDIO%' OR
        UPPER(descricao_local_departamento) LIKE '%WALTER MOREIRA%' OR
        UPPER(descricao_local_departamento) LIKE '%OLAVO SETUBAL%' OR
        UPPER(descricao_local_departamento) LIKE '%EUDORO VILLELA%'
    )

GROUP BY 
    descricao_polo_administrativo
ORDER BY 
    descricao_polo_administrativo;
